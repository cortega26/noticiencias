{% if page.collection == "posts" %}
{% assign author_key = page.author | default: site.author.name | default: "default" %}
{% assign author = site.data.authors[author_key] | default: page.author | default: site.author %}
{% assign author_sameas = "" | split: "" %}
{% if author.links %}
  {% for link in author.links %}
    {% if link.url %}
      {% assign author_sameas = author_sameas | push: link.url %}
    {% endif %}
  {% endfor %}
{% endif %}
{% if author.uri %}
  {% assign author_sameas = author_sameas | push: author.uri %}
{% endif %}
{% assign image_url = page.image.path | default: page.image | default: site.og_image | default: site.logo %}
{% assign citation_urls = "" | split: "" %}
{% if page.sources %}
  {% for source in page.sources %}
    {% if source.url %}
      {% assign citation_urls = citation_urls | push: source.url %}
    {% elsif source.doi %}
      {% assign citation_urls = citation_urls | push: "https://doi.org/" | append: source.doi %}
    {% endif %}
  {% endfor %}
{% endif %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "NewsArticle",
  "headline": "{{ page.title | escape }}",
  "description": "{{ page.excerpt | default: page.description | strip_html | strip_newlines | escape }}",
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  "dateModified": "{{ page.last_modified_at | default: page.date | date_to_xmlschema }}",
  "inLanguage": "{{ page.locale | default: site.locale }}",
  "isAccessibleForFree": true,
  "author": {
    "@type": "Person",
    "name": "{{ author.name | default: page.author | escape }}"{% if author_sameas.size > 0 %},
    "sameAs": {{ author_sameas | jsonify }}{% endif %}
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.title | escape }}",
    "url": "{{ site.url | absolute_url }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.logo | absolute_url }}",
      "width": 512,
      "height": 512
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "{{ image_url | absolute_url }}",
    "width": 800,
    "height": 450
  },
  "articleSection": "{{ page.categories | first | default: "Ciencia" }}",
  "keywords": "{{ page.tags | join: ", " }}",
  "mainEntityOfPage": "{{ page.url | absolute_url }}"{% if citation_urls.size > 0 %},
  "citation": {{ citation_urls | jsonify }}{% endif %}
}
</script>
{% endif %}
